(function(c){var a={},b={};c.fn.autoEllipsis=function(d){d=c.extend({position:"center",tooltip:false,restoreText:false,hasSpan:false,matchText:null},d);return this.each(function(){var s,p,f,n,o,h,e,j,k,g,q=c(this);if(d.restoreText){if(!q.data("autoEllipsis.originalText")){q.data("autoEllipsis.originalText",q.text())}else{q.text(q.data("autoEllipsis.originalText"))}}if(d.hasSpan){s=q.children(d.selector)}else{s=c("<span>").css("whiteSpace","nowrap").text(q.text());q.empty().append(s)}p=q.text();f=s.text();n=q.width();o=0;if(d.matchText){if(!(p in b)){b[p]={}}if(!(d.matchText in b[p])){b[p][d.matchText]={}}if(!(n in b[p][d.matchText])){b[p][d.matchText][n]={}}if(d.position in b[p][d.matchText][n]){q.html(b[p][d.matchText][n][d.position]);if(d.tooltip){q.attr("title",p)}return}}else{if(!(p in a)){a[p]={}}if(!(n in a[p])){a[p][n]={}}if(d.position in a[p][n]){q.html(a[p][n][d.position]);if(d.tooltip){q.attr("title",p)}return}}if(s.width()+o>n){switch(d.position){case"right":h=0;e=f.length;do{g=Math.ceil((h+e)/2);s.text(f.substr(0,g)+"...");if(s.width()+o>n){e=g-1}else{h=g}}while(h<e);s.text(f.substr(0,h)+"...");break;case"center":j=[Math.round(f.length/2),Math.round(f.length/2)];k=1;while(s.outerWidth()+o>n&&j[0]>0){s.text(f.substr(0,j[0])+"..."+f.substr(j[1]));if(k===0){j[0]--;k=1}else{j[1]++;k=0}}break;case"left":e=0;while(s.outerWidth()+o>n&&e<f.length){s.text("..."+f.substr(e));e++}break}}if(d.tooltip){q.attr("title",p)}if(d.matchText){q.highlightText(d.matchText);b[p][d.matchText][n][d.position]=q.html()}else{a[p][n][d.position]=q.html()}})}}(jQuery));